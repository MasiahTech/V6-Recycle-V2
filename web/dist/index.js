import{StrictMode as Y}from"react";import{createRoot as H}from"react-dom/client";import{useState as u,useCallback as O,useEffect as U}from"react";import{useEffect as E,useRef as G}from"react";var p=typeof window.GetParentResourceName!=="function";if(p)document.body.style.background="rgba(0, 0, 0, 0.6)";function V(m,l){window.postMessage({action:m,data:l},"*")}function h(m,l){let r=G(l);E(()=>{r.current=l},[l]),E(()=>{function c(o){let{action:s,data:v}=o.data??{};if(s===m)r.current(v??{})}return window.addEventListener("message",c),()=>window.removeEventListener("message",c)},[m])}async function w(m,l={},r){if(p&&r!==void 0)return console.log(`[NUI Dev] ${m}:`,r),r;if(p)return console.warn(`[NUI Dev] No mock for '${m}'. Pass mockData as 3rd arg.`),{};let c=window.GetParentResourceName();return(await fetch(`https://${c}/${m}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json()}if(p)setTimeout(()=>V("open",{balance:50,totalTraded:1250,rewards:[{item:"plastic",label:"Plastic",rarity:"common",baseChance:45,minAmount:1,maxAmount:3},{item:"metalscrap",label:"Metal Scrap",rarity:"common",baseChance:40,minAmount:1,maxAmount:3},{item:"glass",label:"Glass",rarity:"common",baseChance:35,minAmount:1,maxAmount:2},{item:"copper",label:"Copper",rarity:"uncommon",baseChance:25,minAmount:1,maxAmount:2},{item:"steel",label:"Steel",rarity:"uncommon",baseChance:20,minAmount:1,maxAmount:2},{item:"aluminum",label:"Aluminum",rarity:"uncommon",baseChance:18,minAmount:1,maxAmount:2},{item:"electronics",label:"Electronics",rarity:"rare",baseChance:12,minAmount:1,maxAmount:1},{item:"rubber",label:"Rubber",rarity:"rare",baseChance:10,minAmount:1,maxAmount:2},{item:"goldbar",label:"Gold Bar",rarity:"epic",baseChance:5,minAmount:1,maxAmount:1},{item:"diamond",label:"Diamond",rarity:"epic",baseChance:3,minAmount:1,maxAmount:1}],scaling:[{minAmount:1,maxAmount:10,itemMin:1,itemMax:3},{minAmount:11,maxAmount:25,itemMin:5,itemMax:10},{minAmount:26,maxAmount:50,itemMin:11,itemMax:25},{minAmount:51,maxAmount:100,itemMin:26,itemMax:50},{minAmount:101,maxAmount:999999,itemMin:50,itemMax:100}],sellableItems:[{name:"plastic",label:"Plastic",amount:12,price:15},{name:"metalscrap",label:"Metal Scrap",amount:8,price:18},{name:"copper",label:"Copper",amount:5,price:35},{name:"electronics",label:"Electronics",amount:2,price:75},{name:"goldbar",label:"Gold Bar",amount:1,price:250}]}),100);import{jsx as t,jsxs as a,Fragment as C}from"react/jsx-runtime";var I={common:{border:"border-gray-500/40",text:"text-gray-400",accent:"bg-gray-500/10"},uncommon:{border:"border-emerald-500/40",text:"text-emerald-400",accent:"bg-emerald-500/10"},rare:{border:"border-blue-500/40",text:"text-blue-400",accent:"bg-blue-500/10"},epic:{border:"border-purple-500/40",text:"text-purple-400",accent:"bg-purple-500/10"}};function T(){let[m,l]=u(p),[r,c]=u(null),[o,s]=u(1),[v,g]=u(!1),[x,D]=u(null),[f,y]=u("trade"),[N,M]=u({});h("open",(e)=>{l(!0),c(e),s(Math.min(1,e.balance)),g(!1),y("trade")}),h("close",()=>l(!1)),h("tradeComplete",(e)=>{if(D(e),g(!0),r)c({...r,balance:e.newBalance,totalTraded:e.totalTraded});s(Math.min(1,e.newBalance))});let A=O(()=>{l(!1),g(!1),w("close",{},{success:!0})},[]);U(()=>{let e=(n)=>{if(n.key==="Escape")A()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[A]);let P=()=>{if(!r)return{min:1,max:3};let e=r.scaling.find((n)=>o>=n.minAmount&&o<=n.maxAmount);return{min:e?.itemMin||1,max:e?.itemMax||3}},L=()=>{if(!r||o<1||o>r.balance)return;w("tradeMaterials",{amount:o})},R=(e,n)=>{if(w("sellResource",{itemName:e,amount:n}),r){let i=r.sellableItems.map((b)=>{if(b.name===e)return{...b,amount:Math.max(0,b.amount-n)};return b}).filter((b)=>b.amount>0);c({...r,sellableItems:i}),M({...N,[e]:1})}},S=(e,n)=>{M({...N,[e]:n})};if(!m||!r)return null;let d=P(),$=d.min>1||d.max>3;return t("div",{className:"fixed inset-0 flex items-center justify-center bg-black/10",children:a("div",{className:"w-[800px] max-w-[90vw] max-h-[90vh] bg-black/30 backdrop-blur-sm border border-white/10 rounded-none shadow-2xl overflow-hidden",children:[a("div",{className:"bg-white/[0.02] border-b border-white/10 px-6 py-4",children:[a("div",{className:"flex items-center justify-between mb-3",children:[a("div",{children:[t("h1",{className:"text-xl font-semibold text-white tracking-wide uppercase",children:"Recycle Center"}),t("p",{className:"text-gray-400 text-xs mt-1",children:"Trade materials and sell resources"})]}),t("button",{onClick:A,className:"w-8 h-8 flex items-center justify-center rounded hover:bg-white/10 text-gray-400 hover:text-white transition-all",children:"✕"})]}),a("div",{className:"flex gap-1",children:[t("button",{onClick:()=>{y("trade"),g(!1)},className:`flex-1 px-4 py-2 font-medium text-sm transition-all ${f==="trade"?"bg-white/10 text-white border-b-2 border-white":"bg-transparent text-gray-400 hover:text-white hover:bg-white/5"}`,children:"Trade Materials"}),t("button",{onClick:()=>y("sell"),className:`flex-1 px-4 py-2 font-medium text-sm transition-all ${f==="sell"?"bg-white/10 text-white border-b-2 border-white":"bg-transparent text-gray-400 hover:text-white hover:bg-white/5"}`,children:"Sell Resources"})]})]}),t("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-160px)]",children:f==="trade"?a(C,{children:[a("div",{className:"grid grid-cols-2 gap-3",children:[a("div",{className:"bg-white/[0.02] border border-white/10 p-4",children:[t("div",{className:"text-gray-400 text-xs uppercase tracking-widest mb-2",children:"Current Balance"}),t("div",{className:"text-3xl font-bold text-white",children:r.balance}),t("div",{className:"text-gray-500 text-xs mt-1",children:"Recyclable Materials"})]}),a("div",{className:"bg-white/[0.02] border border-white/10 p-4",children:[t("div",{className:"text-gray-400 text-xs uppercase tracking-widest mb-2",children:"Lifetime Traded"}),t("div",{className:"text-3xl font-bold text-white",children:r.totalTraded}),t("div",{className:"text-gray-500 text-xs mt-1",children:"Total Materials"})]})]}),!v?a(C,{children:[a("div",{className:"bg-white/[0.02] border border-white/10 p-5",children:[a("div",{className:"flex items-center justify-between mb-4",children:[t("label",{className:"text-white font-medium text-sm uppercase tracking-wider",children:"Trade Amount"}),$&&a("span",{className:"text-xs px-2 py-1 bg-emerald-500/20 text-emerald-400 border border-emerald-500/40 font-medium",children:[d.min,"-",d.max," ITEMS"]})]}),t("input",{type:"range",min:"1",max:r.balance,value:o,onChange:(e)=>s(Number(e.target.value)),className:"w-full h-1 bg-white/10 appearance-none cursor-pointer accent-white",style:{background:`linear-gradient(to right, rgb(255 255 255) 0%, rgb(255 255 255) ${o/r.balance*100}%, rgba(255,255,255,0.1) ${o/r.balance*100}%, rgba(255,255,255,0.1) 100%)`}}),a("div",{className:"flex items-center justify-between mt-3",children:[t("input",{type:"number",min:"1",max:r.balance,value:o,onChange:(e)=>s(Math.min(Math.max(1,Number(e.target.value)),r.balance)),className:"w-24 bg-black/30 border border-white/20 px-3 py-2 text-white text-center focus:outline-none focus:border-white/40"}),a("div",{className:"flex gap-2",children:[t("button",{onClick:()=>s(Math.ceil(r.balance*0.25)),className:"px-3 py-1.5 text-xs bg-white/[0.02] hover:bg-white/5 text-gray-300 border border-white/10 transition-colors",children:"25%"}),t("button",{onClick:()=>s(Math.ceil(r.balance*0.5)),className:"px-3 py-1.5 text-xs bg-white/[0.02] hover:bg-white/5 text-gray-300 border border-white/10 transition-colors",children:"50%"}),t("button",{onClick:()=>s(r.balance),className:"px-3 py-1.5 text-xs bg-white/[0.02] hover:bg-white/5 text-gray-300 border border-white/10 transition-colors",children:"MAX"})]})]})]}),a("div",{children:[a("div",{className:"mb-3",children:[t("h2",{className:"text-white font-medium text-sm uppercase tracking-wider",children:"Possible Rewards"}),a("p",{className:"text-xs text-gray-500 mt-1",children:["Each reward gives ",d.min,"-",d.max," items"]})]}),t("div",{className:"grid grid-cols-2 gap-2 max-h-[200px] overflow-y-auto pr-2",children:r.rewards.map((e,n)=>{let i=I[e.rarity];return a("div",{className:`bg-white/[0.02] border ${i.border} ${i.accent} p-3 hover:bg-white/5 transition-all`,children:[t("div",{className:`font-medium text-sm ${i.text}`,children:e.label}),a("div",{className:"text-xs text-gray-400 mt-1",children:[e.baseChance,"% • ",d.min,"-",d.max,"x",$&&t("span",{className:"text-emerald-400 ml-1",children:"↑"})]})]},n)})})]}),a("button",{onClick:L,disabled:o<1||o>r.balance,className:"w-full py-3 bg-white text-black hover:bg-gray-200 disabled:bg-white/10 disabled:text-gray-600 disabled:cursor-not-allowed font-semibold uppercase tracking-wider transition-all text-sm",children:["Trade ",o," Material",o!==1?"s":""]})]}):a(C,{children:[a("div",{className:"bg-white/[0.02] border border-white/10 p-5",children:[t("h2",{className:"text-lg font-semibold text-white mb-4 text-center uppercase tracking-wider",children:"Trade Complete"}),x&&x.rewards.length>0?t("div",{className:"space-y-2",children:x.rewards.map((e,n)=>{let i=I[e.rarity];return a("div",{className:`bg-white/5 border ${i.border} ${i.accent} p-3 flex items-center justify-between`,style:{animationDelay:`${n*0.1}s`},children:[t("span",{className:`font-medium ${i.text}`,children:e.label}),a("span",{className:`font-bold ${i.text}`,children:["+",e.amount,"x"]})]},n)})}):t("div",{className:"text-center text-gray-400 py-4",children:"No items found this time. Better luck next trade!"})]}),t("button",{onClick:()=>g(!1),className:"w-full py-3 bg-white/[0.02] hover:bg-white/10 text-white font-semibold border border-white/20 uppercase tracking-wider transition-all text-sm",children:"Trade Again"})]})]}):a("div",{className:"space-y-3",children:[a("div",{className:"bg-white/5 border border-white/10 p-4",children:[t("h3",{className:"text-white font-medium text-sm uppercase tracking-wider mb-1",children:"Sell Your Resources"}),t("p",{className:"text-gray-400 text-xs",children:"Convert items from trading into cash"})]}),r.sellableItems&&r.sellableItems.length>0?t("div",{className:"space-y-2",children:r.sellableItems.map((e)=>{let n=N[e.name]||1,i=e.amount,b=e.price*n;return a("div",{className:"bg-white/[0.02] border border-white/10 p-4 hover:bg-white/5 transition-all",children:[a("div",{className:"flex items-center justify-between mb-3",children:[a("div",{children:[t("h4",{className:"text-white font-medium text-sm",children:e.label}),a("p",{className:"text-gray-400 text-xs mt-1",children:["$",e.price," each • You have: ",e.amount]})]}),a("div",{className:"text-right",children:[a("div",{className:"text-emerald-400 font-bold text-lg",children:["$",b]}),t("div",{className:"text-gray-500 text-xs",children:"Total Value"})]})]}),a("div",{className:"flex items-center gap-3",children:[t("input",{type:"range",min:"1",max:i,value:n,onChange:(k)=>S(e.name,Number(k.target.value)),className:"flex-1 h-1 bg-white/10 appearance-none cursor-pointer accent-emerald-500",style:{background:`linear-gradient(to right, rgb(16 185 129) 0%, rgb(16 185 129) ${n/i*100}%, rgba(255,255,255,0.1) ${n/i*100}%, rgba(255,255,255,0.1) 100%)`}}),t("input",{type:"number",min:"1",max:i,value:n,onChange:(k)=>S(e.name,Math.min(Math.max(1,Number(k.target.value)),i)),className:"w-16 bg-black/30 border border-white/20 px-2 py-1.5 text-white text-center text-sm focus:outline-none focus:border-white/40"}),t("button",{onClick:()=>R(e.name,n),className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-400 text-black font-medium uppercase text-xs tracking-wider transition-all",children:"Sell"})]}),t("div",{className:"flex gap-2 mt-2",children:a("button",{onClick:()=>R(e.name,i),className:"flex-1 px-3 py-1.5 text-xs bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10 transition-colors uppercase tracking-wider",children:["Sell All (",i,"x)"]})})]},e.name)})}):a("div",{className:"bg-white/5 border border-white/10 p-8 text-center",children:[t("div",{className:"text-gray-400 text-sm mb-2 uppercase tracking-wider",children:"No Resources Available"}),t("p",{className:"text-gray-500 text-xs",children:"Trade materials first to get resources you can sell"})]})]})})]})})}import{jsx as B}from"react/jsx-runtime";var J=H(document.getElementById("root"));J.render(B(Y,{children:B(T,{})}));
